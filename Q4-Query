grunt> A = LOAD 'Crimes_2001_to_present.csv' USING PigStorage(',') AS (ID: chararray, CaseNumber: chararray, Date: chararray, Block: chararray, IUCR: int, PrimaryType: chararray, Description: chararray, LocationDescription: chararray, Arrest: charArray, Domestic: chararray, Beat: int, District: int, Ward: int, CommunityArea: int, FBICode: chararray, XCoordinate: double, YCoordinate: double, Year: int);
grunt> B = FILTER A BY Arrest==‘true’ OR Arrest==‘false’;                                                                                     grunt> C = FOREACH B GENERATE PrimaryType,(INT) SUBSTRING(Date, INDEXOF(Date,' ',1),INDEXOF(Date,':',0)) AS Hour;                             
grunt> D1 = FILTER C BY Hour >= 6 AND Hour < 12;                                                                                              grunt> Morning = FOREACH D1 GENERATE $0, $1, 'morning' AS TimeOfDay;                                                                          grunt> D2 = FILTER C BY Hour >= 12 AND Hour < 18;                                                                                             grunt> Afternoon = FOREACH D2 GENERATE $0, $1, 'afternoon' AS TimeOfDay;                                                                      grunt> D3 = FILTER C BY Hour >= 18 AND Hour < 24;                                                                                             grunt> Evening = FOREACH D3 GENERATE $0, $1, 'evening' AS TimeOfDay;                                                                          grunt> D4 = FILTER C BY Hour >= 0 AND Hour < 6;                                                                                               grunt> Night = FOREACH D4 GENERATE $0, $1, 'night' AS TimeOfDay;                                                                              grunt> E = UNION Morning, Afternoon, Evening, Night;                                                                                          grunt> F = GROUP E BY (PrimaryType, TimeOfDay);                                                                                               grunt> G = FOREACH F GENERATE FLATTEN($0) AS (PrimaryType, TimeOfDay),COUNT(E) AS cnt;                                                        grunt> H = GROUP G BY PrimaryType;                                                                                                            grunt> I = FOREACH H GENERATE group, MAX(G.cnt);                                                                                              grunt> J = JOIN I BY ($0, $1), G BY ($0, $2);                                                                                                 grunt> K = FOREACH J GENERATE $0,$3,$4;  
